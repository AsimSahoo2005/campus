<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sign In — Campus Connect</title>
    <link rel="stylesheet" href="signin.css" />
  </head>
  <body>
    <a class="back" href="welcome.html">← Back to role selection</a>

    <main class="center">
      <form class="card" id="signinForm" action="#" method="post">
        <h2 id="signinTitle">Student Sign In</h2>
        <p class="muted" id="signinSubtitle">Access your student dashboard.</p>

        <label>Email Address
          <input type="email" name="email" placeholder="you@example.com" required />
        </label>

        <label>Password
          <input type="password" name="password" placeholder="••••••••" required />
        </label>

        <button class="primary" type="submit">Sign In</button>

        <p class="small">Don't have an account? <a id="signupLink" href="signup.html">Sign Up</a></p>
      </form>
    </main>
    <script>
      // Detect role from query string
      function getRole() {
        const params = new URLSearchParams(window.location.search);
        return params.get('role') === 'alumni' ? 'alumni' : 'student';
      }
      const role = getRole();
      // Update UI for alumni
      if(role === 'alumni') {
        document.getElementById('signinTitle').textContent = 'Alumni Sign In';
        document.getElementById('signinSubtitle').textContent = 'Access your alumni dashboard.';
        document.getElementById('signupLink').setAttribute('href', 'signup.html?role=alumni');
      }

      // Handle sign in
      document.getElementById('signinForm').addEventListener('submit', function(e){
        e.preventDefault();
        const email = this.email.value.trim();
        const password = this.password.value;
        const storageKey = role === 'alumni' ? 'alumniUsers' : 'studentUsers';
        const profileKey = role === 'alumni' ? 'alumni_profile' : 'campus_profile';
        const users = JSON.parse(localStorage.getItem(storageKey) || '{}');
        if(users[email] && users[email].password === password) {
          // Save profile for session
          localStorage.setItem(profileKey, JSON.stringify(users[email]));
          // Redirect to correct dashboard
          window.location.href = role === 'alumni' ? 'alumni-dashboard.html' : 'dashboard.html';
        } else {
          alert('Invalid email or password.');
        }
      });
    </script>
  </body>
</html>
