<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sign Up — Campus Connect</title>
    <link rel="stylesheet" href="signup.css" />
  </head>
  <body>
    <a class="back" href="welcome.html">← Back to role selection</a>

    <main class="center">
      <form class="card" action="#" method="post" id="signupForm">
        <h2 id="signupTitle">Student Sign Up</h2>
        <p class="muted" id="signupSubtitle">Create your student account.</p>

        <label>Full Name
          <input type="text" name="name" placeholder="John Doe" required />
        </label>

        <label>Email Address
          <input type="email" name="email" placeholder="you@example.com" required />
        </label>

        <label>Password
          <input type="password" name="password" placeholder="••••••" required />
        </label>

        <label>Confirm Password
          <input type="password" name="confirm" placeholder="••••••" required />
        </label>

        <button class="primary" type="submit">Sign Up</button>

        <p class="small">Already have an account? <a id="signinLink" href="signin.html">Sign In</a></p>
      </form>
    </main>
    <script>
      // Detect role from query string
      function getRole() {
        const params = new URLSearchParams(window.location.search);
        return params.get('role') === 'alumni' ? 'alumni' : 'student';
      }
      const role = getRole();
      // Update UI for alumni
      if(role === 'alumni') {
        document.getElementById('signupTitle').textContent = 'Alumni Sign Up';
        document.getElementById('signupSubtitle').textContent = 'Create your alumni account.';
        document.getElementById('signinLink').setAttribute('href', 'signin.html?role=alumni');
      }

      // Save signup info to localStorage and navigate to dashboard
      (function(){
        const form = document.getElementById('signupForm');
        form.addEventListener('submit', function(e){
          e.preventDefault();
          const fd = new FormData(form);
          const name = fd.get('name') || '';
          const email = fd.get('email') || '';
          const password = fd.get('password') || '';
          const confirm = fd.get('confirm') || '';
          if(password !== confirm) {
            alert('Passwords do not match.');
            return;
          }
          const storageKey = role === 'alumni' ? 'alumniUsers' : 'studentUsers';
          const profileKey = role === 'alumni' ? 'alumni_profile' : 'campus_profile';
          const users = JSON.parse(localStorage.getItem(storageKey) || '{}');
          if(users[email]) {
            alert('Account already exists with this email.');
            return;
          }
          const profile = { name, email, password };
          users[email] = profile;
          localStorage.setItem(storageKey, JSON.stringify(users));
          localStorage.setItem(profileKey, JSON.stringify(profile));
          // redirect to correct dashboard
          window.location.href = role === 'alumni' ? 'alumni-dashboard.html' : 'dashboard.html';
        });
      })();
    </script>
  </body>
</html>
