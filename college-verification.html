<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Verification | College Admin</title>
  <link rel="stylesheet" href="college-verification.css">
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-top">
        <div class="sidebar-logo">ğŸ“</div>
      </div>
      <nav class="nav">
        <a href="college-database.html" class="nav-item"><span class="nav-emoji">ğŸ‘¥</span><span class="nav-label">User Database</span></a>
        <a href="college-verification.html" class="nav-item active"><span class="nav-emoji">âœ…</span><span class="nav-label">User Verification</span></a>
        <a href="college-tech-talks.html" class="nav-item"><span class="nav-emoji">ğŸ”Š</span><span class="nav-label">Manage Tech Talks</span></a>
        <a href="college-events.html" class="nav-item"><span class="nav-emoji">ğŸ–¼ï¸</span><span class="nav-label">Past Events Gallery</span></a>
        <a href="college-feed.html" class="nav-item"><span class="nav-emoji">ğŸŒ</span><span class="nav-label">Community Feed</span></a>
        <a href="college-feedback.html" class="nav-item"><span class="nav-emoji">ğŸ’¬</span><span class="nav-label">View Feedback</span></a>
      </nav>
    </aside>
    <header class="topbar">
      <div class="top-left">
        <button id="menuBtn" class="menu" aria-label="Toggle sidebar" aria-expanded="true">â˜°</button>
        <div class="brand">Campus Connect | College</div>
      </div>
      <div class="top-right">
        <div class="profile" id="topProfile">
          <div id="profileTrigger" class="profile-link" tabindex="0" aria-haspopup="true" aria-expanded="false">
            <div class="profile-name" id="topName">Silicon University</div>
            <div class="avatar" id="topAvatar">SU</div>

          </div>
          <div class="profile-menu" id="profileMenu" role="menu" aria-hidden="true">
            <a role="menuitem" href="welcome.html" id="menuLogout">Log out</a>
          </div>
        </div>
      </div>
    </header>
    <main class="main-area">
      <div class="container verification-container">
        <a href="college.html" class="back-link">â† Back to Dashboard</a>
        <div class="verification-header">
          <h1>User Verification</h1>
          <p>Verify the authenticity of student and alumni accounts.</p>
        </div>
        <div class="verification-tabs">
          <div style="display:flex;align-items:center;gap:18px;">
            <button class="tab-btn active" onclick="showTab('students')">Students <span class="tab-count" id="studentCount">0</span></button>
            <button class="tab-btn" onclick="showTab('alumni')">Alumni <span class="tab-count" id="alumniCount">0</span></button>
            <input type="text" class="search-input search-top" id="mainSearch" placeholder="Search by name, email or phone" style="margin-left:24px;min-width:260px;max-width:320px;height:38px;font-size:1rem;">
          </div>
        </div>
        <div class="verification-table" id="studentsTable">
          <div class="table-header">
            <span class="col-name">Name</span>
            <span class="col-phone">Phone</span>
            <span class="col-email">Email</span>
            <span class="col-college">College</span>
            <span class="col-status">Status</span>
          </div>
          <div id="studentsRows"></div>
        </div>
        <div class="verification-table" id="alumniTable" style="display:none;">
          <div class="table-header">
            <span class="col-name">Name</span>
            <span class="col-phone">Phone</span>
            <span class="col-email">Email</span>
            <span class="col-college">College</span>
            <span class="col-status">Status</span>
          </div>
          <div id="alumniRows"></div>
        </div>
      </div>
    </main>
  </div>
  <script>
    // Update tab counts
    function updateCounts() {
      const students = JSON.parse(localStorage.getItem('studentsList') || '[]');
      const alumni = JSON.parse(localStorage.getItem('alumniList') || '[]');
      document.getElementById('studentCount').textContent = students.length;
      document.getElementById('alumniCount').textContent = alumni.length;
    }
    updateCounts();
    function showTab(tab) {
      document.getElementById('studentsTable').style.display = tab === 'students' ? '' : 'none';
      document.getElementById('alumniTable').style.display = tab === 'alumni' ? '' : 'none';
      document.querySelector('.tab-btn.active').classList.remove('active');
      document.querySelectorAll('.tab-btn')[tab === 'students' ? 0 : 1].classList.add('active');
    }
    // Helper to render user rows from localStorage with phone, email, and verify button
    // Helper to render user rows from localStorage with phone, email, and verify button, using flex for alignment
    function renderUserRows(type, users) {
      const container = document.getElementById(type + 'Rows');
      container.innerHTML = '';
      users.forEach((user, idx) => {
        const row = document.createElement('div');
        row.className = 'table-row';
        row.style.display = 'flex';
        row.style.alignItems = 'center';
        // Name column
        const nameDiv = document.createElement('div');
        nameDiv.className = 'col-name';
        nameDiv.textContent = user.name;
        // Phone column
        const phoneDiv = document.createElement('div');
        phoneDiv.className = 'col-phone';
        phoneDiv.textContent = user.phone || '-';
        // Email column
        const emailDiv = document.createElement('div');
        emailDiv.className = 'col-email';
        emailDiv.textContent = user.email || '-';
        // College column
        const collegeDiv = document.createElement('div');
        collegeDiv.className = 'col-college';
        collegeDiv.textContent = user.college;
        // Status column
        const statusDiv = document.createElement('div');
        statusDiv.className = 'col-status user-status ' + (user.verified ? 'verified' : 'not-verified');
        statusDiv.textContent = user.verified ? 'Verified' : 'Not Verified';
        row.appendChild(nameDiv);
        row.appendChild(phoneDiv);
        row.appendChild(emailDiv);
        row.appendChild(collegeDiv);
        row.appendChild(statusDiv);
        if(!user.verified) {
          const btn = document.createElement('button');
          btn.className = 'verify-btn';
          btn.textContent = 'Verify';
          btn.style.marginLeft = '12px';
          btn.onclick = function() {
            user.verified = true;
            localStorage.setItem(type + 'List', JSON.stringify(users));
            renderUserRows(type, users);
            updateCounts();
          };
          row.appendChild(btn);
        }
        container.appendChild(row);
      });
    }

    // Load and render users from localStorage, add sample data if empty
    function loadAndRenderUsers() {
      let students = JSON.parse(localStorage.getItem('studentsList') || '[]');
      let alumni = JSON.parse(localStorage.getItem('alumniList') || '[]');
      // If empty, add sample data
      if (students.length === 0 && alumni.length === 0) {
        students = [
          { name: 'Chakrabiswa123', phone: '9876543210', email: 'chakrabiswa123@gmail.com', college: 'Silicon University', verified: false },
          { name: 'Amit Kumar', phone: '9123456789', email: 'amit.kumar@silicon.edu', college: 'Silicon University', verified: true }
        ];
        alumni = [
          { name: 'Jane Doe', phone: '9988776655', email: 'jane.doe@example.com', college: 'Stanford University', verified: true },
          { name: 'Rahul Sen', phone: '9001122334', email: 'rahul.sen@stanford.edu', college: 'Stanford University', verified: false }
        ];
        localStorage.setItem('studentsList', JSON.stringify(students));
        localStorage.setItem('alumniList', JSON.stringify(alumni));
      }
      renderUserRows('students', students);
      renderUserRows('alumni', alumni);
      updateCounts();
    }
    loadAndRenderUsers();

    // Search functionality (top search bar)
    document.getElementById('mainSearch').addEventListener('input', function(e) {
      const val = e.target.value.toLowerCase();
      const tab = document.querySelector('.tab-btn.active').textContent.trim().toLowerCase();
      if(tab === 'students') {
        const students = JSON.parse(localStorage.getItem('studentsList') || '[]');
        const filtered = students.filter(u =>
          u.name.toLowerCase().includes(val) ||
          (u.email && u.email.toLowerCase().includes(val)) ||
          (u.phone && u.phone.includes(val))
        );
        renderUserRows('students', filtered);
      } else {
        const alumni = JSON.parse(localStorage.getItem('alumniList') || '[]');
        const filtered = alumni.filter(u =>
          u.name.toLowerCase().includes(val) ||
          (u.email && u.email.toLowerCase().includes(val)) ||
          (u.phone && u.phone.includes(val))
        );
        renderUserRows('alumni', filtered);
      }
    });
    (function(){
      const btn = document.getElementById('menuBtn');
      const sidebar = document.querySelector('.sidebar');
      const topbar = document.querySelector('.topbar');
      const main = document.querySelector('.main-area');
      btn.addEventListener('click', function(){
        const collapsed = sidebar.classList.toggle('collapsed');
        topbar.classList.toggle('shifted', collapsed);
        main.classList.toggle('collapsed', collapsed);
        btn.setAttribute('aria-expanded', String(!collapsed));
      });
    })();
    (function(){
      const trigger = document.getElementById('profileTrigger');
      const menu = document.getElementById('profileMenu');
      const container = document.getElementById('topProfile');
      if(!trigger || !menu) return;
      function openMenu(){
        container.classList.add('open');
        trigger.setAttribute('aria-expanded','true');
        menu.setAttribute('aria-hidden','false');
      }
      function closeMenu(){
        container.classList.remove('open');
        trigger.setAttribute('aria-expanded','false');
        menu.setAttribute('aria-hidden','true');
      }
      trigger.addEventListener('click', function(e){
        const isOpen = container.classList.contains('open');
        if(isOpen) closeMenu(); else openMenu();
      });
      document.addEventListener('click', function(e){
        if(!container.contains(e.target)) closeMenu();
      });
      document.addEventListener('keydown', function(e){ if(e.key === 'Escape') closeMenu(); });
      menu.querySelectorAll('a').forEach(a=>a.addEventListener('click', closeMenu));
    })();
  </script>
</body>
</html>
